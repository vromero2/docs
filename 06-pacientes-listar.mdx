# Buscar y Listar Pacientes

La vista de lista de pacientes es tu punto de partida para acceder a la información de cualquier paciente registrado en el sistema.

---

## Acceder a la Lista

1. Haz clic en **"Pacientes"** en el menú lateral
2. Verás la tabla con todos los pacientes registrados

**Ruta**: `/patients` **Permiso requerido**: `list_patients`

![image.png](/Listadodepacientes.png)

---

## Elementos de la Pantalla

### Barra Superior

#### Buscador

- **Ubicación**: Parte superior izquierda
- **Función**: Filtra pacientes en tiempo real
- **Busca por**:
  - Nombre completo
  - Email
  - Teléfono
  - Documento de identidad
  - Número de historia clínica (HC)

**Ejemplo**: Escribe "juan" y verás todos los pacientes con "Juan" en su nombre.

#### Badge de Total

- Muestra la cantidad total de pacientes (filtrados si hay búsqueda activa)
- Ejemplo: "Total de pacientes: 156"

#### Botones de Acción

- **Agregar paciente** (botón azul, ícono +)
  - Permiso: `add_patient`
  - Redirige a formulario de nuevo paciente
- **Importar pacientes** (botón con ícono de descarga)
  - Permiso: `add_patient`
  - Abre modal de importación masiva desde Excel

---

## Tabla de Pacientes

### Columnas de la Tabla

| Columna                 | Contenido                                            | Ordenable |
| ----------------------- | ---------------------------------------------------- | :-------: |
| **Foto**                | Avatar del paciente (logo de la clínica por defecto) | ❌         |
| **Nombre**              | Nombre completo                                      | ✅         |
| **Email**               | Correo electrónico                                   | ❌         |
| **Teléfono**            | Número de contacto                                   | ❌         |
| **Fecha de Nacimiento** | DD/MM/AAAA                                           | ✅         |
| **Documento**           | Número de documento                                  | ✅         |
| **HC**\*                | Número de Historia Clínica                           | ✅         |
| **Acciones**            | Botones de editar y eliminar                         | ❌         |

**Nota**: HC\* = Historia Clínica (pasa el cursor sobre el encabezado para ver el texto completo)

### Interacción con la Tabla

#### Hacer Clic en una Fila

- Cualquier clic en la fila (excepto en los botones de acción) te lleva a la ficha del paciente
- Redirige a: `/patients/:id/data`

#### Ordenar por Columna

1. Haz clic en el encabezado de una columna ordenable
2. **Primer clic**: Orden ascendente (A-Z, 0-9, fecha más antigua primero)
3. **Segundo clic**: Orden descendente (Z-A, 9-0, fecha más reciente primero)
4. **Tercer clic**: Vuelve al orden original

**Columnas ordenables**: Nombre, Fecha de Nacimiento, Documento, HC

---

## Acciones Rápidas

### Botón Editar (Lápiz Azul)

- **Función**: Abre la ficha del paciente en la sección "Información"
- **Permiso**: Visible para todos con `list_patients`
- **Acción**: Redirige a `/patients/:id/data/information`

### Botón Eliminar (Papelera Roja)

- **Función**: Elimina al paciente de forma permanente
- **Permiso**: `delete_patient` (generalmente solo administradores)
- **Advertencia**: Abre confirmación antes de eliminar

#### Confirmación de Eliminación

Cuando haces clic en eliminar:

1. Aparece un modal de confirmación
2. Mensaje: "¿Estás seguro de que deseas eliminar al paciente [Nombre]?"
3. Opciones:
   - **Eliminar** (rojo): Confirma y elimina permanentemente
   - **Cancelar** (gris): Cierra el modal sin hacer nada

**Importante**:

- La eliminación es **permanente** y **no se puede deshacer**
- No podrás eliminar si el paciente tiene:
  - Citas registradas
  - Presupuestos activos
  - Pagos realizados
  - Evoluciones registradas

**Mensaje de error**: "No se puede eliminar este paciente porque tiene datos asociados"

---

## Buscar Pacientes

### Uso del Buscador

1. Haz clic en el campo de búsqueda (o presiona `CTRL + F`)
2. Comienza a escribir
3. La tabla se filtra automáticamente mientras escribes
4. El badge actualiza el contador de resultados

[IMAGEN: Buscador con texto y tabla filtrada]

### Estrategias de Búsqueda Efectiva

#### Por Nombre

```
Ejemplos:
- "juan" → Encuentra: Juan Pérez, Juan García, María Juana
- "perez" → Encuentra: Juan Pérez, María Pérez
- "juan per" → Encuentra: Juan Pérez (búsqueda parcial)
```

#### Por Email

```
Ejemplos:
- "gmail" → Todos los emails @gmail.com
- "juan@" → Emails que empiezan con juan@
```

#### Por Documento

```
Ejemplos:
- "12345" → Todos los documentos que contengan esos dígitos
- "DNI-" → Si usas prefijos en documentos
```

#### Por Número de HC

```
Ejemplos:
- "HC-001" → Historia clínica exacta
- "001" → Parte del número
```

### Limpiar Búsqueda

- Haz clic en la **X** dentro del campo de búsqueda
- O borra todo el texto manualmente
- La tabla muestra todos los pacientes nuevamente

---

## Paginación

Si tienes muchos pacientes, la tabla se divide en páginas.

### Controles de Paginación

[IMAGEN: Barra de paginación en la parte inferior]

- **Ubicación**: Parte inferior de la tabla
- **Resultados por página**: 8 pacientes por defecto
- **Botones**:
  - **Anterior** (\<): Página previa
  - **Números**: Saltar a página específica
  - **Siguiente** (\>): Página siguiente

**Nota**: La búsqueda se aplica a TODOS los pacientes, no solo a la página actual.

---

## Casos de Uso Comunes

### Buscar Paciente para una Cita

**Escenario**: Llega un paciente a consulta y necesitas abrir su ficha rápidamente.

1. Ve a "Pacientes"
2. Escribe su nombre o documento en el buscador
3. Haz clic en su fila
4. Accedes a su expediente completo

### Verificar si un Paciente Está Registrado

**Escenario**: Llama un paciente nuevo y quieres verificar si ya existe en el sistema.

1. Busca por documento o email
2. Si aparece: Ya está registrado
3. Si no aparece: Es nuevo, debes crearlo

### Revisar Lista de Pacientes Activos

**Escenario**: Necesitas un conteo general de tus pacientes.

1. Asegúrate de no tener filtros activos (limpia el buscador)
2. Mira el badge "Total de pacientes"
3. Navega por las páginas para ver listado completo

---

## Funcionalidades Especiales

### Ordenamiento Inteligente

Por defecto, los pacientes se ordenan alfabéticamente por nombre (A-Z).

**Casos útiles de ordenamiento**:

#### Por Fecha de Nacimiento

- **Descendente** (más reciente primero): Ver pacientes más jóvenes
- **Ascendente** (más antigua primero): Ver pacientes más mayores

#### Por Documento

- Útil si usas documentos secuenciales
- Ordena numéricamente, no alfabéticamente

#### Por HC

- Ordena por número de historia clínica
- Útil si asignas HCs secuenciales por orden de llegada

### Badge de Conteo Dinámico

El badge actualiza su número según:

- Total de pacientes si no hay búsqueda
- Total de resultados si hay búsqueda activa

**Ejemplo**:

```
Sin búsqueda: "Total de pacientes: 156"
Con búsqueda: "Total de pacientes: 3" (3 resultados encontrados)
```

---

## Permisos Necesarios

| Acción             | Permiso          | Rol Típico                |
| ------------------ | ---------------- | ------------------------- |
| Ver lista          | `list_patients`  | Todos                     |
| Acceder a ficha    | `list_patients`  | Todos                     |
| Crear paciente     | `add_patient`    | Doctor, Secretaria, Admin |
| Eliminar paciente  | `delete_patient` | Solo Admin                |
| Importar pacientes | `add_patient`    | Admin, Doctor             |

---

## Consejos y Trucos

### Para Secretarias

1. **Usa el buscador constantemente**: No pierdas tiempo navegando manualmente
2. **Busca por teléfono**: Si el paciente no recuerda su email
3. **Verifica duplicados**: Antes de crear paciente, busca por documento

### Para Doctores

1. **Ordena por HC**: Si usas el número de HC como referencia en fichas físicas
2. **Búsqueda rápida**: Durante consulta, busca por apellido
3. **Acceso directo**: Haz clic en la fila para ir directo al expediente

### Para Administradores

1. **Revisa periodicamente**: Busca pacientes duplicados (mismo nombre o documento)
2. **Auditoría**: Ordena por fecha de nacimiento para validar datos coherentes
3. **Limpieza**: Elimina perfiles de prueba o duplicados (con precaución)

---

## Errores Comunes

### "No se encontraron pacientes"

**Causa**: La búsqueda no coincide con ningún registro **Solución**:

- Verifica la ortografía
- Intenta buscar con menos caracteres
- Limpia el filtro y busca manualmente

### No puedo eliminar un paciente

**Causa**: El paciente tiene datos asociados (citas, presupuestos, pagos) **Solución**:

- No es posible eliminar para mantener integridad de datos
- Contacta al administrador si realmente necesitas removerlo

### La búsqueda no funciona

**Causa**: Caracteres especiales o problemas de caché **Solución**:

- Refresca la página (F5)
- Limpia el caché del navegador
- Intenta con otro navegador

### Los pacientes no se ordenan correctamente

**Causa**: Ya hay un orden aplicado previamente **Solución**:

- Haz clic 3 veces en la columna para resetear
- Refresca la página para volver al orden por defecto

---

## Atajos de Teclado

| Atajo      | Acción                                          |
| ---------- | ----------------------------------------------- |
| `CTRL + F` | Enfocar campo de búsqueda                       |
| `ENTER`    | (En fila seleccionada) Abrir ficha del paciente |
| `TAB`      | Navegar entre elementos                         |
| `ESC`      | Limpiar búsqueda                                |

---