# Agenda y Citas - Visión General

El módulo de **Agenda** es el centro de operaciones diarias de tu clínica dental. Aquí gestionas todas las citas, horarios de los doctores y la disponibilidad de la clínica.

---

## ¿Qué es la Agenda?

La agenda es un calendario interactivo que te permite:

- **Visualizar citas**: Ver todos los turnos agendados
- **Crear citas**: Agendar nuevos turnos para pacientes
- **Gestionar citas**: Editar, cancelar o reprogramar turnos
- **Asignar doctores**: Programar citas con profesionales específicos
- **Estados de citas**: Marcar como confirmada, completada, cancelada, etc.
- **Pausas y bloqueos**: Crear espacios no disponibles en la agenda
- **Múltiples vistas**: Ver agenda por día o por semana

---

## Acceso al Módulo

### Desde el Menú Lateral

Haz clic en **"Agenda"** en el menú lateral izquierdo. Esto te llevará a la vista diaria por defecto.

**Permisos Requeridos**:
- **`list_calendar`** - Ver el calendario
- **`add_appointment`** - Crear citas (opcional según tu rol)

---

## Vistas Disponibles

El módulo de agenda ofrece dos vistas principales:

### 1. Vista Diaria (`/calendar/daily`)

Muestra la agenda completa de UN día específico.

**Características**:
- Franja horaria de 6:00 AM a 10:00 PM
- Columnas por doctor (si hay múltiples profesionales)
- Vista detallada de cada cita
- Fácil drag & drop para mover citas
- Ideal para: Gestión del día a día, recepción

[IMAGEN: Vista diaria del calendario con citas]

### 2. Vista Semanal (`/calendar/weekly`)

Muestra la agenda completa de UNA semana (lunes a domingo).

**Características**:
- 7 días en pantalla simultáneamente
- Vista compacta de citas
- Navegación rápida entre semanas
- Identificación de días con mayor carga
- Ideal para: Planificación semanal, coordinación

[IMAGEN: Vista semanal del calendario]

---

## Elementos Comunes en Ambas Vistas

### Barra Superior

#### Selector de Fecha
- **Fecha actual**: Se muestra destacada
- **Botones de navegación**:
  - **Anterior**: Día/semana previa
  - **Hoy**: Volver a la fecha actual
  - **Siguiente**: Día/semana siguiente
- **Selector de fecha**: Hacer clic para elegir fecha específica en calendario

#### Filtro de Doctores
- **Solo si hay múltiples profesionales**
- Dropdown para seleccionar qué doctor(es) ver
- Opciones:
  - Todos los doctores
  - Doctor específico
  - Múltiples doctores

**Permiso requerido**: `select_doctors`

#### Botón "Nueva Cita"
- **Botón azul** con ícono "+"
- Abre modal para crear cita
- **Permiso requerido**: `add_appointment`

#### Botón "Agregar Pausa"
- Crea bloqueos en la agenda (almuerzos, reuniones, etc.)
- **Permiso requerido**: `add_agenda_break`

### Estados de Citas (Colores)

El sistema usa colores para identificar el estado de cada cita:

| Color | Estado | Descripción |
|-------|--------|-------------|
| **Gris claro** | Pendiente | Cita creada pero no confirmada |
| **Azul** | Confirmada | Paciente confirmó su asistencia |
| **Verde** | En curso | La cita está sucediendo ahora |
| **Verde oscuro** | Completada | Atención finalizada |
| **Rojo** | Cancelada | Cita anulada |
| **Naranja** | No asistió | Paciente no se presentó |

**Nota**: Los colores exactos dependen de la configuración de "Estados del Calendario" en Administración.

---

## Información en Cada Cita

Al ver una cita en el calendario, verás:

- **Hora**: Inicio y fin de la cita
- **Paciente**: Nombre completo
- **Doctor**: Profesional asignado (si aplica)
- **Motivo**: Razón de la consulta (si se especificó)
- **Estado**: Color y/o badge del estado actual
- **Duración**: Tiempo estimado (visualizado como altura del bloque)

---

## Flujo de Trabajo Típico

### Para Secretaria/Recepcionista

#### Gestión del Día

1. **Al iniciar el día**:
   - Revisar citas del día en vista diaria
   - Confirmar citas pendientes (llamar a pacientes)
   - Identificar huecos disponibles

2. **Durante el día**:
   - Responder llamadas para agendar citas
   - Marcar citas como "Confirmada" cuando el paciente confirma
   - Cambiar a "En curso" cuando el paciente llega
   - Marcar como "Completada" al finalizar atención
   - Manejar cancelaciones y reprogramaciones

3. **Al finalizar el día**:
   - Marcar "No asistió" para ausencias
   - Preparar agenda del día siguiente

#### Agendar Nueva Cita

1. Paciente llama o llega para solicitar turno
2. Identificar fecha y hora disponible
3. Clic en "Nueva Cita"
4. Completar formulario:
   - Seleccionar paciente (o crear si es nuevo)
   - Elegir fecha y hora
   - Asignar doctor
   - Especificar motivo
   - Definir duración
5. Guardar
6. (Opcional) Enviar confirmación por email/SMS al paciente

### Para Doctor

#### Revisión de Agenda

1. **Al iniciar el día**:
   - Ver citas agendadas en vista diaria
   - Revisar motivos de consulta
   - Identificar pacientes con tratamientos en curso

2. **Durante consultas**:
   - Acceder a expediente del paciente desde la cita
   - Completar evoluciones
   - Agendar próxima cita si es necesario

3. **Al finalizar**:
   - Verificar que todas las citas estén marcadas como completadas

---

## Funcionalidades Especiales

### Drag & Drop (Arrastrar y Soltar)

**En Vista Diaria**:
- Puedes arrastrar una cita a otro horario
- O a otra columna (otro doctor)
- El sistema actualiza automáticamente

**Limitaciones**:
- Solo funciona dentro del mismo día
- Requiere permisos de edición
- No puedes solapar citas

### Clic Rápido para Crear Cita

**En Vista Diaria**:
1. Haz clic en un espacio vacío del calendario
2. Se abre modal con fecha/hora pre-completada
3. Solo completas paciente y motivo

### Notificaciones Automáticas (si está configurado)

El sistema puede enviar:
- **24h antes**: Recordatorio de cita al paciente
- **Al crear**: Confirmación de cita agendada
- **Al cancelar**: Notificación de cancelación

**Nota**: Depende de la configuración del administrador.

---

## Permisos por Funcionalidad

| Acción | Permiso | Rol Típico |
|--------|---------|------------|
| Ver calendario | `list_calendar` | Todos |
| Crear cita | `add_appointment` | Secretaria, Admin, Doctor |
| Editar cita | `edit_appointment` | Secretaria, Admin, Doctor |
| Eliminar cita | `delete_appointment` | Secretaria, Admin |
| Seleccionar doctores | `select_doctors` | Secretaria, Admin |
| Agregar pausa | `add_agenda_break` | Secretaria, Admin, Doctor |

---

## Tipos de Eventos en la Agenda

### 1. Cita Regular
- Turno de paciente para consulta
- Tiene paciente asignado
- Tiene doctor asignado (opcional)
- Color según estado

### 2. Pausa/Bloqueo
- Espacio no disponible para citas
- Ejemplos: Almuerzo, reunión, capacitación
- Color distintivo (generalmente gris oscuro)
- No tiene paciente asignado

### 3. Cita de Emergencia
- Cita creada sin planificación previa
- Generalmente se inserta en huecos pequeños
- Puede tener menor duración que citas regulares

---

## Consejos y Mejores Prácticas

### Organización

1. **Duraciones estándar**: Define duraciones tipo (30min, 1h, 1.5h) según tratamiento
2. **Buffers**: Deja 10-15 minutos entre citas para evitar retrasos
3. **Horarios de almuerzo**: Siempre bloquea con "Pausa"
4. **Colores consistentes**: Usa los mismos estados para facilitar visualización

### Eficiencia

1. **Vista diaria para el día a día**: Más detallada y precisa
2. **Vista semanal para planificación**: Mejor visión general
3. **Confirma citas**: Reduce "No asistió" confirmando 24h antes
4. **Motivos claros**: Ayudan al doctor a prepararse

### Evitar Problemas

1. **No sobrecargar**: Respeta los horarios y duraciones
2. **Verificar doctor**: Confirma que el doctor esté disponible
3. **Doble check paciente**: Asegúrate de seleccionar el paciente correcto
4. **Guardar siempre**: No confíes en guardado automático

---

## Errores Comunes

### "No se puede crear cita en este horario"
**Causa**: Ya existe una cita en ese horario
**Solución**: Busca otro horario disponible

### "El doctor no está disponible"
**Causa**: No hay horario configurado para ese doctor ese día
**Solución**: Contacta al administrador para configurar horarios

### No veo las citas de otros doctores
**Causa**: El filtro está activo mostrando solo un doctor
**Solución**: Cambia filtro a "Todos los doctores"

### Las citas no se guardan
**Causa**: Campos obligatorios sin completar
**Solución**: Verifica que paciente, fecha y hora estén completos

---

## Integración con Otros Módulos

### Pacientes
- Acceso directo al expediente desde la cita
- Crear paciente nuevo desde formulario de cita
- Ver historial de citas en ficha del paciente

### Tratamientos
- Especificar tratamiento al crear cita
- Facilita preparación de materiales

### Recordatorios
- Sistema de recordatorios automáticos (si está activo)
- Configurado en Administración → Recordatorios

---

## Próximos Pasos

- [Vista Diaria Detallada →](./vista-diaria.md)
- [Vista Semanal Detallada →](./vista-semanal.md)
- [Crear una Cita →](./crear-cita.md)
- [Gestionar Citas →](./gestionar-citas.md)
- [Estados de Citas →](./estados-citas.md)

---

[← Volver: Pacientes](../02-pacientes/vision-general.md) | [Siguiente: Vista Diaria →](./vista-diaria.md)
